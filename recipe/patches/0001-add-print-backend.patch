From 8e088261a2aca5c1f3e7e377ea55914d5fef9d12 Mon Sep 17 00:00:00 2001
From: Lorenzo Pirritano <lpirritano@anaconda.com>
Date: Thu, 16 May 2024 13:23:48 +0200
Subject: [PATCH] add print backend

---
 keras/backend/__init__.py |  2 ++
 keras/backend/config.py   | 11 ++++++++++-
 2 files changed, 12 insertions(+), 1 deletion(-)

diff --git a/keras/backend/__init__.py b/keras/backend/__init__.py
index 66e8bcb..98acb70 100644
--- a/keras/backend/__init__.py
+++ b/keras/backend/__init__.py
@@ -1,5 +1,7 @@
 from keras.backend.config import backend
 
+print("!!! backend() ->", backend())
+
 if backend() == "torch":
     # When using the torch backend,
     # torch needs to be imported first, otherwise it will segfault
diff --git a/keras/backend/config.py b/keras/backend/config.py
index 8725e27..a7fb65a 100644
--- a/keras/backend/config.py
+++ b/keras/backend/config.py
@@ -13,7 +13,8 @@ _EPSILON = 1e-7
 _IMAGE_DATA_FORMAT = "channels_last"
 
 # Default backend: TensorFlow.
-_BACKEND = "tensorflow"
+_BACKEND = "torch"
+print("_BACKEND1", _BACKEND)
 
 
 @keras_export(["keras.config.floatx", "keras.backend.floatx"])
@@ -216,6 +217,8 @@ if os.path.exists(_config_path):
     set_epsilon(_epsilon)
     set_image_data_format(_image_data_format)
     _BACKEND = _backend
+    print('_config_path', _config_path)
+    print("_BACKEND4", _BACKEND)
 
 # Save config file, if possible.
 if not os.path.exists(_KERAS_DIR):
@@ -239,12 +242,15 @@ if not os.path.exists(_config_path):
     except IOError:
         # Except permission denied.
         pass
+    print('_config_path5', _config_path)
+    print("_BACKEND5", _BACKEND)
 
 # Set backend based on KERAS_BACKEND flag, if applicable.
 if "KERAS_BACKEND" in os.environ:
     _backend = os.environ["KERAS_BACKEND"]
     if _backend:
         _BACKEND = _backend
+        print("_BACKEND1a", _BACKEND)
 
 
 if _BACKEND != "tensorflow":
@@ -253,6 +259,8 @@ if _BACKEND != "tensorflow":
     # https://www.tensorflow.org/guide/gpu#limiting_gpu_memory_growth
     os.environ["TF_FORCE_GPU_ALLOW_GROWTH"] = "true"
 
+print("_BACKEND3", _BACKEND)
+
 
 @keras_export(
     [
@@ -273,4 +281,5 @@ def backend():
     'tensorflow'
 
     """
+    print("_BACKEND2", _BACKEND)
     return _BACKEND
-- 
2.39.1

