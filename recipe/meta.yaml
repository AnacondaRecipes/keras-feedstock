{% set version = "2.6.0" %}

package:
  name: keras_split
  version: {{ version }}

source:
  - url: https://pypi.io/packages/py2.py3/k/keras/keras-{{ version }}-py2.py3-none-any.whl
    sha256: 504af5656a9829fe803ce48a8580ef16916e89906aceddad9e098614269437e7
  - url: https://raw.githubusercontent.com/keras-team/keras/v{{ version }}/LICENSE
    sha256: ebc07b279109d4bd5e58fe06f54e8f8aee8ba1024b77b222bc04214ae6f56348

build:
  noarch: python
  number: 0

outputs:
  - name: keras-base
    script: install_base.sh  # [not win]
    script: install_base.bat # [win]
    build:
      noarch: python
    requirements:
      host:
        - python >=3.6
        - pip
      run:
        - python >=3.6
        # - numpy >=1.9.1
        # - scipy >=0.14
        # - pyyaml
        # - h5py
        # - tensorflow >=2.2
      # add run_constrained to prevent installation of mismatched keras and
      # keras-base packages
      run_constrained:
        # - keras {{ version }}
        - tensorflow {{ version }}
    test:
      requires:
        - pip
      commands:
        - pip check
      # imports:
        # - keras
        # - keras.backend
        # - keras.datasets
        # - keras.engine
        # - keras.layers
        # - keras.preprocessing
        # - keras.utils
        # - keras.wrappers

  - name: keras
    build:
      script: python -m pip install -vv keras-{{ version }}-py2.py3-none-any.whl
      noarch: true
    requirements:
      host:
        - python >=3.6
        - pip
      run:
        - python >=3.6
      run_constrained:
        - tensorflow {{ version }}
    test:
      requires:
        - pip
      commands:
        - pip check
    about:
      home: https://github.com/fchollet/keras
      license: MIT
      license_family: MIT
      license_file: LICENSE
      summary: Deep Learning Library for Theano and TensorFlow
      description: |
        Keras is a minimalist, highly modular neural networks library
        written in Python and capable on running on top of either
        TensorFlow or Theano. It was developed with a focus on enabling
        fast experimentation. Being able to go from idea to result with
        the least possible delay is key to doing good research.
      doc_url: http://keras.io
      dev_url: https://github.com/fchollet/keras

  - name: keras-gpu
    build:
      noarch: true
    requirements:
      run:
        - keras-base {{ version }}
        - tensorflow-gpu
    about:
      home: https://github.com/fchollet/keras
      license: MIT
      license_family: MIT
      license_file: LICENSE
      summary: Deep Learning Library for Theano and TensorFlow
      description: |
        Keras is a minimalist, highly modular neural networks library
        written in Python and capable on running on top of either
        TensorFlow or Theano. It was developed with a focus on enabling
        fast experimentation. Being able to go from idea to result with
        the least possible delay is key to doing good research.
      doc_url: http://keras.io
      dev_url: https://github.com/fchollet/keras

extra:
  recipe-maintainers:
    - ericdill
    - mariusvniekerk
    - croth1
    - ocefpaf
    - jjhelmus
